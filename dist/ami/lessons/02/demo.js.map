{"version":3,"sources":["../../../../ami/lessons/02/demo.js"],"names":["setupRenderer","container","renderer","document","getElementById","smoothBorders","THREE","WebGLRenderer","antialias","setSize","offsetWidth","offsetHeight","grayBackgroundColor","alpha","setClearColor","setPixelRatio","window","devicePixelRatio","appendChild","domElement","scene","setupScene","Scene","camera","setupCamera","createCamera","fov","aspectRatio","near","far","PerspectiveCamera","setCameraPosition","position","x","y","z","controls","setupControls","AMI","TrackballControl","onWindowResize","aspect","updateProjectionMatrix","type","useCaptureToExecuteEventResponseOnWindowLoad","addEventListener","setupParticleLight","radius","widthSegments","heightSegments","whiteColor","particleLight","Mesh","SphereBufferGeometry","MeshBasicMaterial","color","add","particleLightCreated","setupAmbientLight","blackColor","AmbientLight","setupDirectionalLight","data","directionalLight","DirectionalLight","xPosition","yPosition","zPosition","set","normalize","setupPointLight","pointLightData","sea3dDataObject","pointLight","PointLight","loadDataIntoMesh","loaderSTL","STLLoader","brainMeshURL","load","geometry","mesh","createMesh","red","black","shininessValue","material","MeshPhongMaterial","specular","shininess","setMeshPositionToFit2DImagePlace","RASToLPS","Matrix4","applyMatrix","load2DBrainImage","loaderImage2D","VolumeLoader","brain2DURLfileEndings","files","map","currentFileURLEnding","brainBaseURL","then","series","mergeFilesIntoACleanSeriesStackFrameStructure","mergeSeries","free","currentStack","stack","stackHelper","StackHelper","yellowColor","border","centerLPS","centerCamera","worldCenter","lookAt","centerImage","target","catch","error","console","log","animate","animateParticleLight","timer","Date","now","Math","sin","cos","update","render","requestAnimationFrame"],"mappings":"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","file":"demo.js","sourcesContent":["/* globals AMI*/\r\n\r\nvar {container, renderer} = setupRenderer();\r\n\r\nfunction setupRenderer() {\r\n    var container = document.getElementById('container');\r\n    const smoothBorders = true;\r\n    var renderer = new THREE.WebGLRenderer({\r\n        antialias: smoothBorders\r\n    });\r\n    renderer.setSize(container.offsetWidth, container.offsetHeight);\r\n    const grayBackgroundColor = 0x353535;\r\n    const alpha = 1;\r\n    renderer.setClearColor(grayBackgroundColor, alpha);\r\n    renderer.setPixelRatio(window.devicePixelRatio);\r\n    container.appendChild(renderer.domElement);\r\n    return {container, renderer};\r\n}\r\n\r\n\r\nvar scene = setupScene();\r\n\r\nfunction setupScene() {\r\n    var scene = new THREE.Scene();\r\n    return scene;\r\n}\r\n\r\n\r\nvar camera = setupCamera();\r\n\r\nfunction setupCamera() {\r\n    var camera = createCamera();\r\n\r\n    function createCamera() {\r\n        const fov = 45;\r\n        const aspectRatio = container.offsetWidth / container.offsetHeight;\r\n        const near = 0.01;\r\n        const far = 10000000;\r\n\r\n        var camera = new THREE.PerspectiveCamera(fov, aspectRatio, near, far);\r\n        return camera;\r\n    }\r\n\r\n    setCameraPosition();\r\n\r\n    function setCameraPosition() {\r\n        camera.position.x = 150;\r\n        camera.position.y = 150;\r\n        camera.position.z = 100;\r\n    }\r\n\r\n    return camera;\r\n}\r\n\r\nvar controls = setupControls();\r\n\r\nfunction setupControls() {\r\n    var controls = new AMI.TrackballControl(camera, container);\r\n    return controls;\r\n}\r\n\r\nfunction onWindowResize() {\r\n    camera.aspect = container.offsetWidth / container.offsetHeight;\r\n    camera.updateProjectionMatrix();\r\n    renderer.setSize(container.offsetWidth, container.offsetHeight);\r\n}\r\n\r\nconst type = 'resize';\r\nconst useCaptureToExecuteEventResponseOnWindowLoad = false;\r\nwindow.addEventListener(type, onWindowResize, useCaptureToExecuteEventResponseOnWindowLoad);\r\n\r\nfunction setupParticleLight() {\r\n    const radius = 4;\r\n    const widthSegments = 8;\r\n    const heightSegments = 8;\r\n    const whiteColor = 0xffffff;\r\n    var particleLight = new THREE.Mesh(\r\n        new THREE.SphereBufferGeometry(radius, widthSegments, heightSegments),\r\n        new THREE.MeshBasicMaterial({color: whiteColor})\r\n    );\r\n    scene.add(particleLight);\r\n    return {whiteColor, particleLight};\r\n}\r\n\r\nconst particleLightCreated = setupParticleLight();\r\nconst whiteColor = particleLightCreated.whiteColor;\r\nvar particleLight = particleLightCreated.particleLight;\r\n\r\nsetupAmbientLight();\r\n\r\nfunction setupAmbientLight() {\r\n    const blackColor = 0x222222;\r\n    scene.add(new THREE.AmbientLight(blackColor));\r\n}\r\n\r\n\r\nsetupDirectionalLight();\r\n\r\nfunction setupDirectionalLight() {\r\n    const data = 1;\r\n    var directionalLight = new THREE.DirectionalLight(whiteColor, data);\r\n    const xPosition = 1;\r\n    const yPosition = 1;\r\n    const zPosition = 1;\r\n    directionalLight.position.set(xPosition, yPosition, zPosition).normalize();\r\n    scene.add(directionalLight);\r\n}\r\n\r\n\r\nsetupPointLight();\r\n\r\nfunction setupPointLight() {\r\n    const pointLightData = 2;\r\n    const sea3dDataObject = 800;\r\n    var pointLight = new THREE.PointLight(whiteColor, pointLightData, sea3dDataObject);\r\n    particleLight.add(pointLight);\r\n}\r\n\r\nloadDataIntoMesh();\r\n\r\nfunction loadDataIntoMesh() {\r\n    var loaderSTL = new THREE.STLLoader();\r\n    const brainMeshURL = 'https://cdn.rawgit.com/FNNDSC/data/master/stl/adi_brain/WM.stl';\r\n    loaderSTL.load(brainMeshURL, function (geometry) {\r\n        var mesh = createMesh();\r\n\r\n        function createMesh() {\r\n            const red = 0xf44336;\r\n            const black = 0x111111;\r\n            const shininessValue = 200;\r\n            var material = new THREE.MeshPhongMaterial({color: red, specular: black, shininess: shininessValue});\r\n            var mesh = new THREE.Mesh(geometry, material);\r\n            return mesh;\r\n        }\r\n\r\n\r\n        setMeshPositionToFit2DImagePlace();\r\n\r\n        function setMeshPositionToFit2DImagePlace() {\r\n            var RASToLPS = new THREE.Matrix4();\r\n            RASToLPS.set(-1, 0, 0, 0, 0, -1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);\r\n            mesh.applyMatrix(RASToLPS);\r\n        }\r\n\r\n        scene.add(mesh);\r\n    });\r\n}\r\n\r\n\r\nload2DBrainImage();\r\n\r\nfunction load2DBrainImage() {\r\n    var loaderImage2D = new AMI.VolumeLoader(container);\r\n\r\n    var brain2DURLfileEndings = [\r\n        '36747136',\r\n        '36747150',\r\n        '36747164',\r\n        '36747178',\r\n        '36747192',\r\n        '36747206',\r\n        '36747220',\r\n        '36747234',\r\n        '36747248',\r\n        '36747262',\r\n        '36747276',\r\n        '36747290',\r\n        '36747304',\r\n        '36747318',\r\n        '36747332',\r\n        '36747346',\r\n        '36747360',\r\n        '36747374',\r\n        '36747388',\r\n        '36747402',\r\n        '36747416',\r\n        '36747430',\r\n        '36747444',\r\n        '36747458',\r\n        '36747472',\r\n        '36747486',\r\n        '36747500',\r\n        '36747514',\r\n        '36747528',\r\n        '36747542',\r\n        '36747556',\r\n        '36747570',\r\n        '36747584',\r\n        '36747598',\r\n        '36747612',\r\n        '36747626',\r\n        '36747640',\r\n        '36747654',\r\n        '36747668',\r\n        '36747682',\r\n        '36747696',\r\n        '36747710',\r\n        '36747724',\r\n        '36747738',\r\n        '36747752',\r\n        '36747766',\r\n        '36747780',\r\n        '36747794',\r\n        '36747808',\r\n        '36747822',\r\n        '36747836',\r\n        '36747850',\r\n        '36747864',\r\n        '36747878',\r\n        '36747892',\r\n        '36747906',\r\n        '36747920',\r\n        '36747934',\r\n        '36747948',\r\n        '36747962',\r\n        '36747976',\r\n        '36747990',\r\n        '36748004',\r\n        '36748018',\r\n        '36748032',\r\n        '36748046',\r\n        '36748060',\r\n        '36748074',\r\n        '36748088',\r\n        '36748102',\r\n        '36748116',\r\n        '36748130',\r\n        '36748144',\r\n        '36748158',\r\n        '36748172',\r\n        '36748186',\r\n        '36748578',\r\n        '36748592',\r\n        '36748606',\r\n        '36748620',\r\n        '36748634',\r\n        '36748648',\r\n        '36748662',\r\n        '36748676',\r\n        '36748690',\r\n        '36748704',\r\n        '36748718',\r\n        '36748732',\r\n        '36748746',\r\n        '36748760',\r\n        '36748774',\r\n        '36748788',\r\n        '36748802',\r\n        '36748816',\r\n        '36748830',\r\n        '36748844',\r\n        '36748858',\r\n        '36748872',\r\n        '36748886',\r\n        '36748900',\r\n        '36748914',\r\n        '36748928',\r\n        '36748942',\r\n        '36748956',\r\n        '36748970',\r\n        '36748984',\r\n        '36748998',\r\n        '36749012',\r\n        '36749026',\r\n        '36749040',\r\n        '36749054',\r\n        '36749068',\r\n        '36749082',\r\n        '36749096',\r\n        '36749110',\r\n        '36749124',\r\n        '36749138',\r\n        '36749152',\r\n        '36749166',\r\n        '36749180',\r\n        '36749194',\r\n        '36749208',\r\n        '36749222',\r\n        '36749236',\r\n        '36749250',\r\n        '36749264',\r\n        '36749278',\r\n        '36749292',\r\n        '36749306',\r\n        '36749320',\r\n        '36749334',\r\n        '36749348',\r\n        '36749362',\r\n        '36749376',\r\n        '36749390',\r\n        '36749404',\r\n        '36749418',\r\n        '36749446',\r\n        '36749460',\r\n        '36749474',\r\n        '36749488',\r\n        '36749502',\r\n        '36749516',\r\n        '36749530',\r\n        '36749544',\r\n        '36749558',\r\n        '36749572',\r\n        '36749586',\r\n        '36749600',\r\n        '36749614',\r\n        '36749628',\r\n        '36749642',\r\n        '36749656',\r\n        '36749670',\r\n        '36749684',\r\n        '36749698',\r\n        '36749712',\r\n        '36749726',\r\n        '36749740',\r\n        '36749754',\r\n        '36749768',\r\n        '36749782',\r\n        '36749796',\r\n        '36749810',\r\n        '36749824',\r\n        '36749838',\r\n        '36749852',\r\n        '36749866',\r\n        '36749880',\r\n        '36749894',\r\n        '36749908',\r\n        '36749922',\r\n        '36749936',\r\n        '36749950',\r\n        '36749964'\r\n    ];\r\n\r\n    var files = brain2DURLfileEndings.map(function (currentFileURLEnding) {\r\n        const brainBaseURL = 'https://cdn.rawgit.com/FNNDSC/data/master/dicom/adi_brain/';\r\n        return brainBaseURL + currentFileURLEnding;\r\n    });\r\n\r\n    loaderImage2D\r\n        .load(files)\r\n        .then(function () {\r\n            var series = mergeFilesIntoACleanSeriesStackFrameStructure();\r\n\r\n            function mergeFilesIntoACleanSeriesStackFrameStructure() {\r\n                var series = loaderImage2D.data[0].mergeSeries(loaderImage2D.data);\r\n                return series;\r\n            }\r\n\r\n            loaderImage2D.free();\r\n            loaderImage2D = null;\r\n\r\n            const currentStack = series[0].stack[0];\r\n            var stackHelper = new AMI.StackHelper(currentStack);\r\n            const yellowColor = 0xffeb3b;\r\n            stackHelper.border.color = yellowColor;\r\n\r\n            scene.add(stackHelper);\r\n\r\n            var centerLPS = centerCamera();\r\n\r\n            function centerCamera() {\r\n                var centerLPS = stackHelper.stack.worldCenter();\r\n                camera.lookAt(centerLPS.x, centerLPS.y, centerLPS.z);\r\n                camera.updateProjectionMatrix();\r\n                return centerLPS;\r\n            }\r\n\r\n            centerImage();\r\n\r\n            function centerImage() {\r\n                controls.target.set(centerLPS.x, centerLPS.y, centerLPS.z);\r\n            }\r\n\r\n        })\r\n        .catch(function (error) {\r\n            window.console.log('oops... something went wrong...');\r\n            window.console.log(error);\r\n        });\r\n}\r\n\r\n\r\nfunction animate() {\r\n    animateParticleLight();\r\n\r\n    function animateParticleLight() {\r\n        var timer = Date.now() * 0.00025;\r\n\r\n        particleLight.position.x = Math.sin(timer * 7) * 100;\r\n        particleLight.position.y = Math.cos(timer * 5) * 120;\r\n        particleLight.position.z = Math.cos(timer * 3) * 140;\r\n    }\r\n\r\n\r\n    controls.update();\r\n    renderer.render(scene, camera);\r\n\r\n    requestAnimationFrame(function () {\r\n        animate();\r\n    });\r\n}\r\n\r\nanimate();\r\n"]}